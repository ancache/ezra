# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://jashkenas.github.com/coffee-script/

$(document).ready ->
	$('.tablesorter').tablesorter()
	$('.help').tooltip({html: true})

	# Look up if feature name exists
	$('#nonunique').hide()
	$('#feature_name').keyup ->
		$.ajax '/features/check_feature_uniqueness',
				type: 'POST',
				dataType: 'json',
				data: {
					id: window.location.pathname.split('/')[2],
					name: $(this).val(),
				},
				success: (response) ->
					console.log(response)
					if response.exists
						$('#nonunique').show()
						$('input[name=commit]').attr("disabled",true)
					else
						$('#nonunique').hide()
						$('input[name=commit]').attr("disabled",false)


	# Update feature
	count = 1
	$('#add-new').click ->
		count++
		$('#feature-list').append('<input type="text" value="" name="feature[fvalues][]" placeholder="Add feature" data-count="'+count+'" /><br/>')

	# Edit features
	$('#edit-box').hide()
	$('#edit-feature-alert').alert()
	$('.yes').click ->
		$('#edit-feature-alert').alert('close')
		$('#edit-box').show()

